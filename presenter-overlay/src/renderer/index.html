<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self' https://*.googleapis.com https://*.gstatic.com https://*.firebaseio.com wss://*.firebaseio.com; script-src 'self' 'unsafe-inline' https://www.gstatic.com; style-src 'self' 'unsafe-inline'; connect-src 'self' https://*.googleapis.com https://*.firebaseio.com wss://*.firebaseio.com;">
  <title>Live Reactions Overlay</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Setup Panel (shown initially) -->
  <div id="setup-panel" class="setup-panel">
    <div class="setup-card">
      <button id="close-btn" class="close-btn" title="Close App">‚úï</button>
      <h1>Live Reactions</h1>
      <p class="subtitle">Enter your room code to start receiving reactions</p>

      <div class="input-group">
        <input
          type="text"
          id="room-input"
          placeholder="Room code (e.g., myTalk2024)"
          autocomplete="off"
          autocapitalize="off"
          spellcheck="false"
        >
        <button id="start-btn">Start</button>
      </div>

      <div id="status" class="status">
        <span class="status-dot"></span>
        <span class="status-text">Ready</span>
      </div>

      <div class="help-text">
        <p>Audience URL: <strong>remote.rohan-dhanawade.de</strong></p>
        <p class="hint">Press Escape to show/hide this panel</p>
      </div>

      <button id="test-btn" class="test-btn">Test Emojis</button>
    </div>
  </div>

  <!-- Questions Container (left side - just emoji) -->
  <div id="questions-container" class="questions-container"></div>

  <!-- Emoji Container (floating emojis appear here - right side) -->
  <div id="emoji-container" class="emoji-container"></div>

  <!-- Reaction Counter (optional, shows in corner) -->
  <div id="reaction-counter" class="reaction-counter hidden">
    <span id="counter-value">0</span> reactions
  </div>

  <!-- Status Overlay (shown with Ctrl+Shift+L) -->
  <div id="status-overlay" class="status-overlay hidden">
    <div class="status-card">
      <h2>Live Reactions</h2>
      <div class="status-info">
        <div class="status-row">
          <span class="status-label">Room:</span>
          <span id="status-room-code" class="status-value">---</span>
        </div>
        <div class="status-row">
          <span class="status-label">Status:</span>
          <span class="status-value">
            <span id="status-overlay-dot" class="status-dot connected"></span>
            <span id="status-overlay-text">Connected</span>
          </span>
        </div>
        <div class="status-row">
          <span class="status-label">Reactions:</span>
          <span id="status-reaction-count" class="status-value">0</span>
        </div>
      </div>

      <!-- Workshop Pace Section -->
      <div class="pace-status">
        <p class="pace-status-title">Workshop Pace</p>
        <div class="pace-stats">
          <div class="pace-stat">
            <span class="pace-stat-icon">üê¢</span>
            <span id="pace-slow-count" class="pace-stat-count">0</span>
            <span class="pace-stat-label">Too Slow</span>
          </div>
          <div class="pace-stat pace-stat-good">
            <span class="pace-stat-icon">üëç</span>
            <span id="pace-good-count" class="pace-stat-count">0</span>
            <span class="pace-stat-label">Just Right</span>
          </div>
          <div class="pace-stat">
            <span class="pace-stat-icon">üêá</span>
            <span id="pace-fast-count" class="pace-stat-count">0</span>
            <span class="pace-stat-label">Too Fast</span>
          </div>
        </div>
      </div>

      <!-- Questions Section -->
      <div class="questions-status">
        <div class="questions-header">
          <p class="questions-status-title">Questions (<span id="questions-count">0</span>)</p>
          <button id="clear-questions-btn" class="btn-clear-questions">Clear All</button>
        </div>
        <div id="questions-list" class="questions-list">
          <p class="questions-empty">No questions yet</p>
        </div>
      </div>

      <!-- Reactions Toggle -->
      <div class="reactions-toggle-section">
        <label class="toggle-label">
          <input type="checkbox" id="reactions-toggle" checked>
          <span class="toggle-slider"></span>
          <span class="toggle-text">Show Reactions on Screen</span>
        </label>
      </div>

      <div class="status-actions">
        <button id="view-feedback-btn" class="btn-feedback">View Feedback</button>
        <button id="leave-room-btn" class="btn-leave">Leave Room</button>
        <button id="close-status-btn" class="btn-close-status">Close</button>
      </div>
      <p class="status-hint">Press Ctrl+Shift+L or Escape to close</p>
    </div>
  </div>

  <!-- Feedback Overlay -->
  <div id="feedback-overlay" class="feedback-overlay hidden">
    <div class="feedback-card">
      <button id="feedback-back-btn" class="feedback-back-btn">‚Üê Back</button>
      <button id="feedback-close-btn" class="feedback-close-btn">‚úï</button>
      <h2>Session Feedback</h2>

      <div class="feedback-stats">
        <div class="feedback-stat-main">
          <span id="feedback-avg-rating" class="feedback-avg-rating">-</span>
          <div class="feedback-stars" id="feedback-stars">
            <span class="star-display">‚òÜ</span>
            <span class="star-display">‚òÜ</span>
            <span class="star-display">‚òÜ</span>
            <span class="star-display">‚òÜ</span>
            <span class="star-display">‚òÜ</span>
          </div>
          <span id="feedback-total-count" class="feedback-total">0 reviews</span>
        </div>
        <div class="feedback-distribution">
          <div class="rating-bar">
            <span class="rating-label">5</span>
            <div class="rating-bar-track"><div id="rating-bar-5" class="rating-bar-fill"></div></div>
            <span id="rating-count-5" class="rating-count">0</span>
          </div>
          <div class="rating-bar">
            <span class="rating-label">4</span>
            <div class="rating-bar-track"><div id="rating-bar-4" class="rating-bar-fill"></div></div>
            <span id="rating-count-4" class="rating-count">0</span>
          </div>
          <div class="rating-bar">
            <span class="rating-label">3</span>
            <div class="rating-bar-track"><div id="rating-bar-3" class="rating-bar-fill"></div></div>
            <span id="rating-count-3" class="rating-count">0</span>
          </div>
          <div class="rating-bar">
            <span class="rating-label">2</span>
            <div class="rating-bar-track"><div id="rating-bar-2" class="rating-bar-fill"></div></div>
            <span id="rating-count-2" class="rating-count">0</span>
          </div>
          <div class="rating-bar">
            <span class="rating-label">1</span>
            <div class="rating-bar-track"><div id="rating-bar-1" class="rating-bar-fill"></div></div>
            <span id="rating-count-1" class="rating-count">0</span>
          </div>
        </div>
      </div>

      <div class="feedback-comments-section">
        <h3>Recent Comments</h3>
        <div id="feedback-comments" class="feedback-comments">
          <p class="feedback-loading">Loading feedback...</p>
        </div>
      </div>
    </div>
  </div>

  <script src="emoji-animator.js"></script>
  <script src="firebase-listener.js"></script>
  <script src="renderer.js"></script>
</body>
</html>
